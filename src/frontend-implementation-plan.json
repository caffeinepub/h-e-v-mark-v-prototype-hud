{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Default STANDARD mode, add installable Android PWA, and improve mobile scaling + touch UX",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Default to STANDARD display mode on first load and after SYSTEM RESTART resets.",
      "acceptanceCriteria": [
        "A fresh app load (no prior in-memory state) starts in STANDARD display mode.",
        "Using the existing \"SYSTEM RESTART\" action resets the display mode to STANDARD.",
        "All user-facing labels remain in English (e.g., \"STANDARD\")."
      ],
      "file_operations": [
        {
          "path": "frontend/src/state/infoSettingsState.ts",
          "operation": "modify",
          "description": "Update the settings store initialState so displayMode defaults to \"STANDARD\" (and therefore resets to STANDARD when reset() is invoked by SYSTEM RESTART)."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Add PWA manifest, icons, and service worker registration to enable Android install + offline app shell caching.",
      "acceptanceCriteria": [
        "The app includes a valid web app manifest and is linked from the HTML entrypoint.",
        "The app registers a service worker that enables offline-capable caching of the app shell (at minimum: HTML, JS bundle(s), CSS, and static assets required to render the UI).",
        "On Android Chrome (or equivalent), the browser offers an install option (\"Add to Home screen\" / install prompt) and the installed app launches in standalone/app-like mode.",
        "PWA icons are provided in appropriate sizes and referenced by the manifest."
      ],
      "file_operations": [
        {
          "path": "frontend/public/manifest.webmanifest",
          "operation": "create",
          "description": "Create a web app manifest configured for standalone display mode, with app name/short_name, start_url/scope, theme/background colors, and icon references for Android installability."
        },
        {
          "path": "frontend/public/pwa/icon-192.png",
          "operation": "create",
          "description": "Add a 192x192 PWA icon asset referenced by the manifest."
        },
        {
          "path": "frontend/public/pwa/icon-512.png",
          "operation": "create",
          "description": "Add a 512x512 PWA icon asset referenced by the manifest."
        },
        {
          "path": "frontend/public/pwa/icon-512-maskable.png",
          "operation": "create",
          "description": "Add a 512x512 maskable PWA icon asset referenced by the manifest (purpose: \"maskable\") for better Android icon rendering."
        },
        {
          "path": "frontend/index.html",
          "operation": "modify",
          "description": "Link the manifest and add PWA-related meta tags (including theme-color) in the HTML head so Android Chrome recognizes the app as installable."
        },
        {
          "path": "frontend/public/service-worker.js",
          "operation": "create",
          "description": "Create a service worker that pre-caches an app-shell set (HTML, manifest, icons, and critical static assets) and provides offline-capable caching behavior for same-origin GET requests."
        },
        {
          "path": "frontend/src/pwa/registerServiceWorker.ts",
          "operation": "create",
          "description": "Add a small helper to register the service worker on supported browsers and report registration failures (no UI text changes)."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Call the service worker registration helper during app startup (after boot overlay completion is acceptable) to enable installability and offline caching. Use existing shadcn-ui composition already present in this file; verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Improve mobile readability via automatic responsive scaling and safe-area-aware layout adjustments without affecting desktop.",
      "acceptanceCriteria": [
        "UI scale is automatically optimized for small screens (in addition to the existing manual UI scale slider), without breaking desktop layout.",
        "Key navigation elements (tabs list, headers/footers, primary controls) remain readable and do not overflow/clamp on narrow widths.",
        "The layout respects mobile safe areas (e.g., notch/gesture areas) so critical controls are not obscured.",
        "No changes are required to backend APIs to achieve the scaling improvements."
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useAutoUiScale.ts",
          "operation": "create",
          "description": "Implement a lightweight hook that derives an automatic scale multiplier from viewport size/orientation (e.g., based on innerWidth/innerHeight breakpoints) and updates on resize/orientation changes."
        },
        {
          "path": "frontend/src/components/hud/HudLayout.tsx",
          "operation": "modify",
          "description": "Incorporate the auto scale hook to compute an effective HUD scale (manual uiScale * auto multiplier) and apply it via CSS variables on the HUD container; also add safe-area inset CSS variables/classes as needed for mobile."
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Adjust global HUD CSS to (1) use the effective scale variable for font/layout sizing, (2) add safe-area padding for header/footer/tab bars/content using env(safe-area-inset-*), and (3) refine narrow-width layout so tabs/header/footer remain readable without overflow."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Make interactions touch-friendly by increasing tap targets, removing hover-only affordances on touch devices, and preserving desktop mouse/keyboard behavior.",
      "acceptanceCriteria": [
        "Interactive controls meet touch-friendly sizing (e.g., comfortably tappable triggers/buttons) without requiring zoom.",
        "Tab switching and other primary interactions work reliably via touch (no dependence on hover to discover or operate controls).",
        "Scrolling areas (e.g., tab content panels/logs) remain scrollable and do not conflict with touch interactions.",
        "Any touch interactions added do not regress mouse/keyboard behavior on desktop."
      ],
      "file_operations": [
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Update CSS for touch devices: increase minimum sizes/padding for primary controls (e.g., tab triggers), add touch-action where appropriate, add iOS momentum scrolling for scroll areas, and gate hover-specific effects behind hover-capable media queries to avoid hover-only affordances on touch."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Ensure primary navigation controls (TabsList/TabsTrigger from shadcn-ui) remain reliably tappable on touch by applying any necessary class adjustments or wrappers consistent with existing styling. Verify the component's usage instructions before implementing."
        }
      ]
    }
  ]
}